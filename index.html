<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFF Flex Sender</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body class="bg-gray-100 h-screen flex flex-col items-center justify-center p-4">

    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-sm text-center">
        <img id="profileImage" src="https://via.placeholder.com/150" alt="Profile" 
             class="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-[#06c755] hidden">
        
        <h1 class="text-xl font-bold text-gray-800 mb-2">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ì <span id="displayName">...</span></h1>
        <p id="statusMessage" class="text-sm text-gray-500 mb-6">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î LIFF...</p>

        <button id="btnShare" disabled 
                class="w-full bg-[#06c755] hover:bg-[#05b34c] text-white font-bold py-3 px-4 rounded transition duration-200 opacity-50 cursor-not-allowed">
            ‡∏™‡πà‡∏á Flex Message ‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
        </button>
    </div>

    <script>
        // üö® 1. ‡πÉ‡∏™‡πà LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        const MY_LIFF_ID = "YOUR_LIFF_ID_HERE"; 

        async function main() {
            try {
                // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô LIFF
                await liff.init({ liffId: MY_LIFF_ID });

                // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà Login ‡πÉ‡∏´‡πâ‡∏™‡∏±‡πà‡∏á Login
                if (!liff.isLoggedIn()) {
                    liff.login();
                    return;
                }

                // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                const profile = await liff.getProfile();
                document.getElementById('displayName').innerText = profile.displayName;
                document.getElementById('statusMessage').innerText = "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!";
                
                const img = document.getElementById('profileImage');
                if (profile.pictureUrl) {
                    img.src = profile.pictureUrl;
                    img.classList.remove('hidden');
                }

                // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°
                const btn = document.getElementById('btnShare');
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');

            } catch (err) {
                document.getElementById('statusMessage').innerText = "Error: " + err.message;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á
        document.getElementById('btnShare').onclick = async () => {
            if (liff.isApiAvailable('shareTargetPicker')) {
                try {
                    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Flex Message ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á
                    const flexMessage = {
                        "type": "flex",
                        "altText": "‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà",
                        "contents": {
                            "type": "bubble",
                            "hero": {
                                "type": "image",
                                "url": "https://scdn.line-apps.com/n/channel_devcenter/img/fx/01_1_cafe.png",
                                "size": "full",
                                "aspectRatio": "20:13",
                                "aspectMode": "cover"
                            },
                            "body": {
                                "type": "box",
                                "layout": "vertical",
                                "contents": [
                                    { "type": "text", "text": "Brown Cafe", "weight": "bold", "size": "xl" },
                                    { "type": "text", "text": "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏ã‡∏∑‡πâ‡∏≠ 1 ‡πÅ‡∏ñ‡∏° 1", "color": "#aaaaaa", "size": "sm" }
                                ]
                            },
                            "footer": {
                                "type": "box",
                                "layout": "vertical",
                                "contents": [
                                    {
                                        "type": "button",
                                        "style": "primary",
                                        "color": "#905c44",
                                        "action": { "type": "uri", "label": "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", "uri": "https://line.me" }
                                    }
                                ]
                            }
                        }
                    };

                    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
                    const result = await liff.shareTargetPicker([flexMessage]);
                    
                    if (result) {
                        alert("‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
                        liff.closeWindow(); // ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á LIFF ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à
                    }
                } catch (error) {
                    alert("‚ùå ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + error);
                }
            } else {
                alert("‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏ô‡πÅ‡∏≠‡∏õ LINE ‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
            }
        };

        main();
    </script>
</body>
</html>
